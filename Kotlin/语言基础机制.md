# Kotlin学习

Kotlin之所以可以在JVM上执行，是因为JVM只认字节码。

函数式编程的个人理解就是：函数本身也是对象，有其特定的类型系统，例如(Int, Int) -> Int， 这就是一个类型（Class）。因为函数也是变量/对象，所以可以把它们作为返回值、参数等原本只有一般对象可以充当的身份。语言中许多特殊的语法，都是根据这个思想来设计的了。



## 字符串模板

用$在字符串中引用变量，避免了字符串拼接的麻烦。

比如在字符串中引用变量：

```kotlin
println("hello, $name")
printlin("The first argument is ${arg[0]}")
```



## 枚举类

```kotlin
enmu class Color{
  RED,GREEN	
}
```

枚举类可以有其自己的属性和方法：

```kotlin
enum class Color(val r: Int,val g: Int, val b: Int){
	RED(255, 0,0);
	fun rgb = (r * 256 + g)*256 + b
}
```

注意定义方法前要在属性末尾加上分号。



## 函数

```kotlin
fun sum(x: Int, y: Int): Int{return x + y}//类似于常用语言中的函数定义
fun sum(x: Int, y: Int) = x + y //用表达式的形式来定义函数
```

以上方式定义的sum，实际上都是(Int, Int) -> Int类型。

Tips:

1. 一般函数**返回值类型**都需要显式指定(表达式类型不需要)；
2. 函数参数类型都需要指定
3. 又返回值的代码块函数体，必须显示写





##  var与val

```kotlin
val book = Book()
```

book是指向堆中该对象的引用，val代表引用本身不可变，但引用指向的对象可变。

若将引用理解为对象实体的地址变量，则地址变量本身不可变，但目的地的对象可变。

val变量也可以晚初始化，但是要提前表明类型。如：

```kotlin
val a: Int
a = 1
```





## 函数式编程

函数可以像变量一样传来传去，或者说函数本身就被当成了复杂组合的基本元素。可以将函数作为参数传入到一个函数中。

函数类型就类似于我们当时解释器做的sml语言：

(参数类型列表) -> 返回值类型

```kotlin
(Int, String) -> Int
() -> Int
//也可以给参数取名字
(name: String, code: Int) -> Unit
//在类型后加上?代表可选

//参数类型和返回值也可设定为另一个函数类型：
((Int)-> Int) -> Int //参数为函数类型
()  -> ((Int) -> Int) //返回值为函数类型
```

（Kotlin中抛弃了基本变量类型，全部使用对象类型，因此Int的i是大写的。

### Lambda表达式

```kotlin
val foo: (Int, Int) -> Int = {x, y -> x + y}
val too = {x: Int, y: Int ->x + y}
```



## 逻辑控制

kotlin中的逻辑控制，如if，并不是一般语句，而是表达式（求值出来会有一个结果返回值，如1+1就是表达式）。

if的特殊用法是if可以有返回值，例子如下：

if每一个block的最后一行代码作为返回值。

```kotlin
fun getIfRes(name : String):String = if(name.length == 1){
    name
}else{
    "0"
}
```



when类似于switch的变体，但when后的值类型没有限制，可以是任意类型的对象，甚至是setOf(a, b)。

```kotlin
fun getScore(tag: String) :Int = when(tag){
    "a" -> 1
    "b" -> 2
    else ->{100}
}
```

when后面的对象也不是必须的，可以用如下的写法：

```kotlin
fun whenTest(a : Int, b : Int){
    when{
        (a == 1 && b == 1)-> println("a == 1")
        else -> println("else")
    }
}
```

->前面的是一般的布尔表达式，而不是将when后的对象与->前面的对象做相等判断产生的布尔值了。

->后面不仅可以是表达式，也可以是代码块block（花括号）

## 循环

+ while(与java相同)
+ for-in

```kotlin
for(i in 0..10){}
for(j in 0 until 10 step 2)
for(k in 10 downTo 1)
```

也可用来**遍历集合**，跟python中的for-in一样，多了个括号。

## 面向对象

**kotlin中的类默认不可被继承，相当于加了final**

若希望其被继承则加上open:

```kotlin
open class Person{
}
```

继承：

```kotlin
class Student : Person(){}
```

接口：

```kotlin
interface IA{}
//实现接口与继承一样，不过不用加括号
class Student : IA{}
```

类型智能转换：

用is关键字可以判断某个对象对象是否为某个类型：

` a is A`

往往a是作为父类对象传入，A是子类类型，is执行完之后，**a此后便被当作A类型，可以访问A类型的属性**。

## 权限

默认是public而非包内可见。protected仅对当前类和子类可见。

internal：

只对同一个模块内的类可见。



## 数据类与单例类

分别用data和object关键字即可

```kotlin
data class Cell(val num : Int)
val c = Cell(100)

object SingleTon{
	//定义数据和操作
}
SingleTon.foo()
//此处并非静态方法调用，而是编译器会自动e构建一个类
```



//后面看另外两本书再补充，第一行代码Android讲kotlin实在一般。





